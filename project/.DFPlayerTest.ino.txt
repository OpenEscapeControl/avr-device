#include "SoftwareSerial.h"
#include "DFPlayer.h"
#include "proto_dfplayer.h"

String str;

uint8_t data[10];

void setup()
{
    Serial.begin(115200);
}

void loop()
{
    if(Serial.available())
    {
        str = Serial.readStringUntil(' ');
        if(str == "begin")
        {
            data[0] = CMD_DFPLAYER_BEGIN;
            data[1] = Serial.parseInt();
            data[2] = Serial.parseInt();
            data[3] = Serial.parseInt();
            processCommandDFPlayer(data, 4);
            Serial.print("begin ");
            Serial.print(data[1]);
            Serial.print(" ");
            Serial.print(data[2]);
            Serial.print(" ");
            Serial.print(data[3]);
            Serial.print("\n");
        }
        else if(str == "playFolder")
        {
            data[0] = CMD_DFPLAYER_PLAYFOLDER;
            data[1] = Serial.parseInt();
            data[2] = Serial.parseInt();
            data[3] = Serial.parseInt();
            processCommandDFPlayer(data, 4);
            Serial.print("playFolder ");
            Serial.print(data[1]);
            Serial.print(" ");
            Serial.print(data[2]);
            Serial.print(" ");
            Serial.print(data[3]);
            Serial.print("\n");
        }
        else if(str == "stop")
        {
            data[0] = CMD_DFPLAYER_STOP;
            data[1] = Serial.parseInt();
            processCommandDFPlayer(data, 2);
            Serial.print("stop ");
            Serial.print(data[1]);
            Serial.print("\n");
        }
        else if(str == "pause")
        {
            data[0] = CMD_DFPLAYER_PAUSE;
            data[1] = Serial.parseInt();
            processCommandDFPlayer(data, 2);
            Serial.print("pause ");
            Serial.print(data[1]);
            Serial.print("\n");
        }
        else if(str == "start")
        {
            data[0] = CMD_DFPLAYER_START;
            data[1] = Serial.parseInt();
            processCommandDFPlayer(data, 2);
            Serial.print("start ");
            Serial.print(data[1]);
            Serial.print("\n");
        }
        else if(str == "volume")
        {
            data[0] = CMD_DFPLAYER_VOLUME;
            data[1] = Serial.parseInt();
            data[2] = Serial.parseInt();
            processCommandDFPlayer(data, 3);
            Serial.print("volume ");
            Serial.print(data[1]);
            Serial.print(" ");
            Serial.print(data[2]);
            Serial.print("\n");
        }
        else if(str == "end")
        {
            data[0] = CMD_DFPLAYER_END;
            data[1] = Serial.parseInt();
            processCommandDFPlayer(data, 2);
            Serial.print("end ");
            Serial.print(data[1]);
            Serial.print("\n");
        }
    }
}

